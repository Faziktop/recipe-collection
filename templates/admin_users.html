{% extends "base.html" %}

{% block content %}
<div class="admin-panel">
    <h2><i class="fas fa-crown"></i> Панель администратора</h2>
    <div class="admin-links">
        <a href="{{ url_for('admin_all_recipes') }}" class="admin-link">Все рецепты</a>
        <a href="{{ url_for('admin_users') }}" class="admin-link">Пользователи</a>
        <a href="{{ url_for('index') }}" class="admin-link">На главную</a>
    </div>
</div>

<h2>Все пользователи</h2>
<p>Всего пользователей: {{ users|length }}</p>

{% if users %}
<table class="admin-table">
    <thead>
        <tr>
            <th>ID</th>
            <th>Имя</th>
            <th>Email</th>
            <th>Админ</th>
            <th>Дата регистрации</th>
            <th>Рецептов</th>
            <th>Действия</th>
        </tr>
    </thead>
    <tbody>
        {% for user in users %}
        <tr>
            <td>{{ user.id }}</td>
            <td>
                {{ user.username }}
                {% if user.is_admin %}<span class="admin-badge">ADMIN</span>{% endif %}
                {% if user.id == current_user.id %}<span class="admin-badge">ВЫ</span>{% endif %}
            </td>
            <td>{{ user.email }}</td>
            <td>{% if user.is_admin %}Да{% else %}Нет{% endif %}</td>
            <td>{{ user.created_at.strftime('%d.%m.%Y') }}</td>
            <td>{{ user.recipes|length }}</td>
            <td>
                {% if not user.is_admin and user.id != current_user.id %}
                <form action="{{ url_for('admin_delete_user', user_id=user.id) }}" method="POST" class="delete-form">
                    <button type="submit" class="btn btn-delete btn-small" 
                            onclick="return confirm('Удалить пользователя «{{ user.username }}» и все его рецепты?')">
                        <i class="fas fa-trash"></i> Удалить
                    </button>
                </form>
                {% else %}
                <span class="text-muted">Недоступно</span>
                {% endif %}
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% else %}
<div class="no-recipes">
    <i class="fas fa-users"></i>
    <h3>Пока нет пользователей</h3>
</div>
{% endif %}
{% endblock %}